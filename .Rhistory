xlab("Season")
league_data %>%
ggplot(aes(x = season, y = feild_goals_made / feild_goals_attempted)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season <= 1997), mapping = aes(color = "red"))
league_data %>%
ggplot(aes(x = season, y = feild_goals_made / feild_goals_attempted)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1997), mapping = aes(color = "red"))
league_data %>%
ggplot(aes(x = season, y = feild_goals_made / feild_goals_attempted)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1996), mapping = aes(color = "red"))
ylab("Shooting Percentage") +
xlab("Season") +
scale_color_manual(name = "",
breaks = c("Seasons with 22 ft three point line"),
values = c("red"))
ylab("Shooting Percentage") +
xlab("Season")
league_data %>%
ggplot(aes(x = season, y = feild_goals_made / feild_goals_attempted)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1996), mapping = aes(color = "red")) +
ylab("Shooting Percentage") +
xlab("Season") +
scale_color_manual(name = "",
breaks = c("Seasons with 22 ft three point line"),
values = c("red"))
league_data %>%
ggplot(aes(x = season, y = feild_goals_made / feild_goals_attempted)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1996), mapping = aes(color = "Seasons with 22 ft three point line")) +
ylab("Shooting Percentage") +
xlab("Season") +
scale_color_manual(name = "",
breaks = c("Seasons with 22 ft three point line"),
values = c("red"))
league_data %>%
ggplot(aes(x = season, y = feild_goals_made / feild_goals_attempted)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1996), mapping = aes(color = "Seasons with 22 ft three point line")) +
ylab("Shooting Percentage") +
xlab("Season") +
scale_color_manual(name = "",
breaks = c("Seasons with 22 ft three point line"),
values = c("red")) +
theme(legend.position = "bottom")
league_data %>%
ggplot(aes(x = season, y = feild_goals_made / feild_goals_attempted)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1996), mapping = aes(color = "Seasons with 22 ft three point line")) +
ylab("Shooting Percentage") +
xlab("Season") +
scale_color_manual(name = "",
breaks = c("Seasons with 22 ft three point line"),
values = c("red")) +
theme(legend.position = "bottom") +
title("Shooting Percentage Over The Seasons")
league_data %>%
ggplot(aes(x = season, y = feild_goals_made / feild_goals_attempted)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1996), mapping = aes(color = "Seasons with 22 ft three point line")) +
ylab("Shooting Percentage") +
xlab("Season") +
scale_color_manual(name = "",
breaks = c("Seasons with 22 ft three point line"),
values = c("red")) +
theme(legend.position = "bottom") +
ggtitle("Shooting Percentage Over The Seasons")
league_data %>%
ggplot(aes(x = season, y = three_pointers_attempted / two_pointers_attempted)) +
geom_point() +
geom_point(aes(color = "Implemented"),
fill = "black",
shape = 21,
stroke = 2,
data = filter(league_data, season == 1994)) +
geom_point(aes(color = "Retracted"),
fill = "black",
shape = 21,
stroke = 2,
data = filter(league_data, season == 1997)) +
scale_color_manual(name = "Three Point Range Reduction",
breaks = c("Implemented", "Retracted"),
values = c("Implemented" = "red", "Retracted" = "blue")) +
xlab("Season") +
ylab("Three Pointer to Two Pointer Ratio") +
ggtitle("Three to Two Point Attempt Ratio Over the Seasons")
league_data %>%
ggplot(aes(x = season, y = three_pointers_attempted / two_pointers_attempted)) +
geom_point() +
geom_point(aes(color = "Implemented"),
fill = "black",
shape = 21,
stroke = 2,
data = filter(league_data, season == 1994)) +
geom_point(aes(color = "Retracted"),
fill = "black",
shape = 21,
stroke = 2,
data = filter(league_data, season == 1997)) +
scale_color_manual(name = "Three Point Range Reduction",
breaks = c("Implemented", "Retracted"),
values = c("Implemented" = "red", "Retracted" = "blue")) +
xlab("Season") +
ylab("Three Pointer to Two Pointer Ratio") +
ggtitle("Three to Two Point Attempt Ratio Over the Seasons") +
theme(legend.position = "bottom")
league_data %>%
ggplot(aes(x = season, y = points / games_played)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1996), mapping = aes(color = "Seasons with 22 ft three point line")) +
ylab("Shooting Percentage") +
xlab("Season") +
scale_color_manual(name = "",
breaks = c("Seasons with 22 ft three point line"),
values = c("red")) +
theme(legend.position = "bottom") +
ggtitle("Shooting Percentage Over The Seasons")
league_data %>%
ggplot(aes(x = season, y = points / games_played)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1996), mapping = aes(color = "Seasons with 22 ft three point line")) +
ylab("Average Points Per Game") +
xlab("Season") +
scale_color_manual(name = "",
breaks = c("Seasons with 22 ft three point line"),
values = c("red")) +
theme(legend.position = "bottom") +
ggtitle("Average Points Per Game Over The Seasons")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
game_data <- read_csv(
"data/game.csv",
col_types = cols(
season_id = col_integer(),
team_id_home = col_integer(),
team_id_away = col_integer(),
game_id = col_integer(),
)
)
game_data <- game_data %>%
mutate(home_win = ifelse(wl_home == "W", TRUE, FALSE)) %>%
mutate(away_win = ifelse(wl_away == "W", TRUE, FALSE)) %>%
mutate(video_available_home = ifelse(video_available_home == 1, TRUE, FALSE)) %>%
mutate(video_available_away = ifelse(video_available_away == 1, TRUE, FALSE)) %>%
select(-c(wl_home, wl_away))
game_data
# summarize each team's yearly statistics for their home and away games
team_data_home <- game_data %>%
filter(year(game_date) >= 1986) %>%
rename(team_id = team_id_home) %>%
select(-contains("away"))
team_data_away <- game_data %>%
filter(year(game_date) >= 1986) %>%
rename(team_id = team_id_away) %>%
select(-contains("home"))
# remove the home and away suffixes on both data sets so their rows can be bound
names(team_data_home) <- gsub("_home", "", names(team_data_home))
names(team_data_away) <- gsub("_away", "", names(team_data_away))
# function that determines the current NBA season based on year
nba_season <- function (date) {
ifelse(
month(date) %in% 9:12,
year(date),
year(date) - 1
)
}
# bind the rows, group by team and year, and add summary statistics for each
# season
team_data <- team_data_home %>%
bind_rows(team_data_away) %>%
arrange(game_date) %>%
group_by(team_id, season_id) %>%
summarise(
season = nba_season(first(game_date)),
team_name = last(team_name),
team_abbreviation = last(team_abbreviation),
games_played = n(),
feild_goals_made = sum(fgm),
feild_goals_attempted = sum(fga),
three_pointers_made = sum(fg3m),
three_pointers_attempted = sum(fg3a),
two_pointers_attempted = feild_goals_attempted - three_pointers_attempted,
two_pointers_made = feild_goals_made - three_pointers_made,
free_throws_made = sum(ftm),
free_throws_attempted = sum(fta),
offensive_rebounds = sum(oreb),
deffensive_rebounds = sum(dreb),
rebounds = sum(dreb),
assits = sum(ast),
steals = sum(stl),
blocks = sum(blk),
turnovers = sum(tov),
fouls = sum(pf),
points = sum(pts),
plus_minus = sum(plus_minus)
)  %>%
mutate(
across(-c("team_name", "team_abbreviation", "games_played"),
(function (x) x / games_played),
.names = "avg_{.col}_per_game"),
feild_goal_percentage = feild_goals_made / feild_goals_attempted,
two_point_percentage = two_pointers_made / two_pointers_attempted,
three_point_percentage = three_pointers_made / three_pointers_attempted,
free_throw_percentage = free_throws_made / free_throws_attempted,
)
team_data
league_data <- team_data %>%
group_by(season) %>%
summarise(across(-c("team_name", "team_abbreviation"), sum)) %>%
mutate(
across(
c("feild_goals_made",
"feild_goals_attempted",
"two_pointers_made",
"two_pointers_attempted",
"three_pointers_made",
"three_pointers_attempted",
"free_throws_made",
"free_throws_attempted",
"points"
),
(function(x) x / games_played),
.names = "avg_{.col}_per_game"
),
feild_goal_percentage = feild_goals_made / feild_goals_attempted,
two_point_percentage = two_pointers_made / two_pointers_attempted,
three_point_percentage = three_pointers_made / three_pointers_attempted,
free_throw_percentage = free_throws_made / free_throws_attempted,
)
player_stats <- read_csv("./data/player_stats.csv")
player_stats <- player_stats %>%
rename(
position = pos,
league = lg,
team_name = tm,
games = g,
games_started = gs,
minuptes_played = mp,
feild_goals = fg,
feild_goals_attempted = fga,
feild_goal_percentage = fg_percent,
three_pointers_made = x3p,
three_pointers_attempted = x3pa,
three_point_percentage = x3p_percent,
two_pointers_made = x2p,
two_pointers_attempted = x2pa,
two_point_percentage = x2p_percent,
effective_feild_goal_percentage = e_fg_percent,
free_throws_made = ft,
free_throws_attempted = fta,
offensive_rebounds = orb,
defensive_rebounds = drb,
total_rebounds = trb,
assists = ast,
steals = stl,
blocks = blk,
turnovers = tov,
personal_fouls = pf,
points = pts
)
league_data %>%
ggplot(aes(x = season, y = three_pointers_attempted / two_pointers_attempted)) +
geom_point() +
geom_point(aes(color = "Implemented"),
fill = "black",
shape = 21,
stroke = 2,
data = filter(league_data, season == 1994)) +
geom_point(aes(color = "Retracted"),
fill = "black",
shape = 21,
stroke = 2,
data = filter(league_data, season == 1997)) +
scale_color_manual(name = "Three Point Range Reduction",
breaks = c("Implemented", "Retracted"),
values = c("Implemented" = "red", "Retracted" = "blue")) +
xlab("Season") +
ylab("Three Pointer to Two Pointer Ratio") +
ggtitle("Three to Two Point Attempt Ratio Over the Seasons") +
theme(legend.position = "bottom")
league_data %>%
ggplot(aes(x = season, y = points / games_played)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1996), mapping = aes(color = "Seasons with 22 ft three point line")) +
ylab("Average Points Per Game") +
xlab("Season") +
scale_color_manual(name = "",
breaks = c("Seasons with 22 ft three point line"),
values = c("red")) +
theme(legend.position = "bottom") +
ggtitle("Average Points Per Game Over The Seasons")
lm(points / games_played ~ season, filter(league_data, 1994 <= season & season <= 1996))
lm(points / games_played ~ season, filter(league_data, 1994 <= season & season <= 1996))
lm(points / games_played ~ season, filter(league_data, season < 1994))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
game_data <- read_csv(
"data/game.csv",
col_types = cols(
season_id = col_integer(),
team_id_home = col_integer(),
team_id_away = col_integer(),
game_id = col_integer(),
)
)
game_data <- game_data %>%
mutate(home_win = ifelse(wl_home == "W", TRUE, FALSE)) %>%
mutate(away_win = ifelse(wl_away == "W", TRUE, FALSE)) %>%
mutate(video_available_home = ifelse(video_available_home == 1, TRUE, FALSE)) %>%
mutate(video_available_away = ifelse(video_available_away == 1, TRUE, FALSE)) %>%
select(-c(wl_home, wl_away))
game_data
# summarize each team's yearly statistics for their home and away games
team_data_home <- game_data %>%
filter(year(game_date) >= 1986) %>%
rename(team_id = team_id_home) %>%
select(-contains("away"))
team_data_away <- game_data %>%
filter(year(game_date) >= 1986) %>%
rename(team_id = team_id_away) %>%
select(-contains("home"))
# remove the home and away suffixes on both data sets so their rows can be bound
names(team_data_home) <- gsub("_home", "", names(team_data_home))
names(team_data_away) <- gsub("_away", "", names(team_data_away))
# function that determines the current NBA season based on year
nba_season <- function (date) {
ifelse(
month(date) %in% 9:12,
year(date),
year(date) - 1
)
}
# bind the rows, group by team and year, and add summary statistics for each
# season
team_data <- team_data_home %>%
bind_rows(team_data_away) %>%
arrange(game_date) %>%
group_by(team_id, season_id) %>%
summarise(
season = nba_season(first(game_date)),
team_name = last(team_name),
team_abbreviation = last(team_abbreviation),
games_played = n(),
feild_goals_made = sum(fgm),
feild_goals_attempted = sum(fga),
three_pointers_made = sum(fg3m),
three_pointers_attempted = sum(fg3a),
two_pointers_attempted = feild_goals_attempted - three_pointers_attempted,
two_pointers_made = feild_goals_made - three_pointers_made,
free_throws_made = sum(ftm),
free_throws_attempted = sum(fta),
offensive_rebounds = sum(oreb),
deffensive_rebounds = sum(dreb),
rebounds = sum(dreb),
assits = sum(ast),
steals = sum(stl),
blocks = sum(blk),
turnovers = sum(tov),
fouls = sum(pf),
points = sum(pts),
plus_minus = sum(plus_minus)
)  %>%
mutate(
across(-c("team_name", "team_abbreviation", "games_played"),
(function (x) x / games_played),
.names = "avg_{.col}_per_game"),
feild_goal_percentage = feild_goals_made / feild_goals_attempted,
two_point_percentage = two_pointers_made / two_pointers_attempted,
three_point_percentage = three_pointers_made / three_pointers_attempted,
free_throw_percentage = free_throws_made / free_throws_attempted,
)
team_data
league_data <- team_data %>%
group_by(season) %>%
summarise(across(-c("team_name", "team_abbreviation"), sum)) %>%
mutate(
across(
c("feild_goals_made",
"feild_goals_attempted",
"two_pointers_made",
"two_pointers_attempted",
"three_pointers_made",
"three_pointers_attempted",
"free_throws_made",
"free_throws_attempted",
"points"
),
(function(x) x / games_played),
.names = "avg_{.col}_per_game"
),
feild_goal_percentage = feild_goals_made / feild_goals_attempted,
two_point_percentage = two_pointers_made / two_pointers_attempted,
three_point_percentage = three_pointers_made / three_pointers_attempted,
free_throw_percentage = free_throws_made / free_throws_attempted,
)
player_stats <- read_csv("./data/player_stats.csv")
player_stats <- player_stats %>%
rename(
position = pos,
league = lg,
team_name = tm,
games = g,
games_started = gs,
minuptes_played = mp,
feild_goals = fg,
feild_goals_attempted = fga,
feild_goal_percentage = fg_percent,
three_pointers_made = x3p,
three_pointers_attempted = x3pa,
three_point_percentage = x3p_percent,
two_pointers_made = x2p,
two_pointers_attempted = x2pa,
two_point_percentage = x2p_percent,
effective_feild_goal_percentage = e_fg_percent,
free_throws_made = ft,
free_throws_attempted = fta,
offensive_rebounds = orb,
defensive_rebounds = drb,
total_rebounds = trb,
assists = ast,
steals = stl,
blocks = blk,
turnovers = tov,
personal_fouls = pf,
points = pts
)
league_data %>%
ggplot(aes(x = season, y = three_pointers_attempted / two_pointers_attempted)) +
geom_point() +
geom_point(aes(color = "Implemented"),
fill = "black",
shape = 21,
stroke = 2,
data = filter(league_data, season == 1994)) +
geom_point(aes(color = "Retracted"),
fill = "black",
shape = 21,
stroke = 2,
data = filter(league_data, season == 1997)) +
scale_color_manual(name = "Three Point Range Reduction",
breaks = c("Implemented", "Retracted"),
values = c("Implemented" = "red", "Retracted" = "blue")) +
xlab("Season") +
ylab("Three Pointer to Two Pointer Ratio") +
ggtitle("Three to Two Point Attempt Ratio Over the Seasons") +
theme(legend.position = "bottom")
league_data %>%
ggplot(aes(x = season, y = points / games_played)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1996), mapping = aes(color = "Seasons with 22 ft three point line")) +
ylab("Average Points Per Game") +
xlab("Season") +
scale_color_manual(name = "",
breaks = c("Seasons with 22 ft three point line"),
values = c("red")) +
theme(legend.position = "bottom") +
ggtitle("Average Points Per Game Over The Seasons")
lm(points / games_played ~ season, filter(league_data, season < 1994))
lm(points / games_played ~ season, filter(league_data, 1994 <= season & season <= 1996))
league_data %>%
ggplot(aes(x = season, y = points / games_played)) +
geom_point() +
geom_smooth(data = filter(league_data, season < 1994), method = "lm", se = FALSE) +
geom_smooth(data = filter(league_data, 1994 <= season & season <= 1996), method = "lm", se = FALSE) +
geom_point(data = filter(league_data, 1994 <= season & season <= 1996), mapping = aes(color = "Seasons with 22 ft three point line")) +
ylab("Average Points Per Game") +
xlab("Season") +
scale_color_manual(name = "",
breaks = c("Seasons with 22 ft three point line"),
values = c("red")) +
theme(legend.position = "bottom") +
ggtitle("Average Points Per Game Over The Seasons")
lead(three_pointers_attempted)
lead(league_data$three_pointers_attempted)
(league_data$three_pointers_attempted)
league_data %>%
mutate(delta_tpr = three_pointers_attempted / two_pointers_attempted -
lag(three_pointers_attempted) - lag(two_pointers_attempted)) %>%
ggplot(aes(season, delta_tpr)) +
geom_bar()
league_data %>%
mutate(delta_tpr = three_pointers_attempted / two_pointers_attempted -
lag(three_pointers_attempted) - lag(two_pointers_attempted)) %>%
ggplot(aes(season, delta_tpr)) +
geom_bar(stat = identity)
league_data %>%
mutate(delta_tpr = three_pointers_attempted / two_pointers_attempted -
lag(three_pointers_attempted) - lag(two_pointers_attempted)) %>%
ggplot(aes(season, delta_tpr)) +
geom_bar(stat = "identity")
league_data %>%
mutate(delta_tpr = three_pointers_attempted / two_pointers_attempted -
lag(three_pointers_attempted) / lag(two_pointers_attempted)) %>%
ggplot(aes(season, delta_tpr)) +
geom_bar(stat = "identity")
